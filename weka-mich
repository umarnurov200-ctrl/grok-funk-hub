<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Grok's Funk Hub</title>
  <meta name="description" content="Grok's Funk Hub ‚Äî –º—É–∑—ã–∫–∞, –∞—Ä—Ç—ã –∏ —Å–≤–µ–∂–µ–µ. –î–æ–±–∞–≤–ª—è–π –¥—Ä–æ–ø—ã –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å." />
  <style>
    :root{
      --bg-top:#0f0f23;
      --bg-bottom:#1a1a2e;
      --accent:#00ff88;
      --muted: rgba(0,255,136,0.08);
      --mono: "Courier New", monospace;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      min-height:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      font-family:var(--mono);
      color:var(--accent);
      background:linear-gradient(to bottom,var(--bg-top),var(--bg-bottom));
      padding:20px;
      -webkit-font-smoothing:antialiased;
    }
    header{max-width:900px;width:100%;text-align:center}
    h1{
      margin:8px 0 4px;
      font-size:2.6rem;
      text-shadow:0 0 10px var(--accent);
    }
    p.lead{margin:4px 0 18px;color:var(--accent);opacity:0.95}
    main{max-width:900px;width:100%}
    .new-drop{
      background:var(--muted);
      padding:18px;
      margin:16px 0;
      border-radius:10px;
      border:1px solid rgba(0,255,136,0.06);
    }
    .drop-header{display:flex;align-items:center;gap:16px;flex-wrap:wrap}
    .cover{
      width:120px;height:120px;flex:0 0 120px;border-radius:8px;
      border:2px solid var(--accent);
      object-fit:cover;background:#0a0a12;
    }
    .meta{flex:1;text-align:left}
    h2{margin:0 0 6px;font-size:1.25rem}
    .meta p{margin:0;color:var(--accent);opacity:0.9}
    audio{width:100%;margin-top:12px;border-radius:6px}
    ul{margin:8px 0 0;padding-left:20px}
    footer{margin-top:18px;opacity:0.9}
    .controls{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-bottom:10px}
    button{
      background:transparent;border:1px solid var(--accent);color:var(--accent);padding:8px 12px;border-radius:8px;
      cursor:pointer;font-family:var(--mono);
    }
    button:hover{background:rgba(0,255,136,0.04)}
    @media (max-width:600px){
      .drop-header{flex-direction:column;align-items:center}
      .cover{width:220px;height:220px}
    }
  </style>
</head>
<body>
  <header>
    <h1>üöÄ Grok's Funk Hub</h1>
    <p class="lead">–¢–≤–æ–π –ª–∏—á–Ω—ã–π –≤–∞–π–± –æ—Ç –º–µ–Ω—è ‚Äî –º—É–∑—ã–∫–∞, –∞—Ä—Ç—ã –∏ –≤—Å—ë —Å–≤–µ–∂–µ–µ! –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è–π –Ω–æ–≤—ã–µ –¥—Ä–æ–ø—ã –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.</p>
    <div class="controls" role="toolbar" aria-label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–æ–ø–∞–º–∏">
      <button id="add-track">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–∫</button>
      <button id="add-art">üñºÔ∏è –î–æ–±–∞–≤–∏—Ç—å –∞—Ä—Ç</button>
      <button id="reset-sample">‚ôªÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –≤ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>
      <button id="export">üìÅ –≠–∫—Å–ø–æ—Ä—Ç JSON</button>
    </div>
  </header>

  <main id="drops-container" aria-live="polite">
    <!-- –î—Ä–æ–ø—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–∫—Ä–∏–ø—Ç–æ–º -->
  </main>

  <footer>
    <p>–°–¥–µ–ª–∞–Ω–æ –¥–ª—è —Ç–µ–±—è Grok'–æ–º. –ü–∏—à–∏: "–¥–æ–±–∞–≤—å —Ç—Ä–µ–∫" ‚Äî –æ–±–Ω–æ–≤–ª—é! üî• (–ª–æ–∫–∞–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ)</p>
  </footer>

  <script>
    // –ù–µ–±–æ–ª—å—à–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, function(c){
        return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c];
      });
    }

    // –ù–∞—á–∞–ª—å–Ω—ã–µ –¥—Ä–æ–ø—ã (–ø—Ä–∏–º–µ—Ä)
    const defaultDrops = [
      {
        id: 'funk-2025',
        kind: 'track',
        title: 'Funk You Very Much 2025',
        bpm: '110 bpm',
        duration: '3:47',
        audioUrl: 'https://vocaroo.com/1mN4kXzQ7pLq', // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é MP3-—Å—Å—ã–ª–∫—É –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏
        audioType: 'audio/mpeg',
        cover: 'https://via.placeholder.com/300x300/0f0f23/00ff88?text=Funk+You+Very+Much',
        downloadUrl: 'https://krakenfiles.com/view/4vT8yP2mN1/file.html'
      },
      {
        id: 'next-art',
        kind: 'art',
        title: 'Next Funk (–∞—Ä—Ç)',
        cover: 'https://via.placeholder.com/200x200/ff6b6b/ffffff?text=Next+Funk',
        note: '–ê—Ä—Ç –ø—Ä–µ–≤—å—é'
      }
    ];

    const STORAGE_KEY = 'groks-funk-hub.drops.v1';

    function loadDrops(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return defaultDrops.slice();
        const parsed = JSON.parse(raw);
        if(Array.isArray(parsed)) return parsed;
        return defaultDrops.slice();
      }catch(e){
        console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä–æ–ø—ã:', e);
        return defaultDrops.slice();
      }
    }

    function saveDrops(arr){
      try{
        localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
      }catch(e){
        console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥—Ä–æ–ø—ã:', e);
      }
    }

    function createDropElement(drop){
      const container = document.createElement('section');
      container.className = 'new-drop';
      container.setAttribute('data-id', drop.id || '');
      const header = document.createElement('div');
      header.className = 'drop-header';

      const img = document.createElement('img');
      img.className = 'cover';
      img.alt = escapeHtml(drop.title || 'Cover');
      img.src = drop.cover || '';
      header.appendChild(img);

      const meta = document.createElement('div');
      meta.className = 'meta';

      const title = document.createElement('h2');
      title.textContent = drop.title || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è';
      meta.appendChild(title);

      if(drop.kind === 'track'){
        const p = document.createElement('p');
        p.textContent = (drop.bpm ? drop.bpm + ' ¬∑ ' : '') + (drop.duration ? drop.duration : '');
        meta.appendChild(p);

        // Audio player
        if(drop.audioUrl){
          const audio = document.createElement('audio');
          audio.controls = true;
          audio.preload = 'none';
          const source = document.createElement('source');
          source.src = drop.audioUrl;
          if(drop.audioType) source.type = drop.audioType;
          audio.appendChild(source);
          // fallback text + download link
          const fallback = document.createElement('div');
          fallback.innerHTML = '–¢–≤–æ–π –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ. ' + 
            (drop.downloadUrl ? '<a href="'+escapeHtml(drop.downloadUrl)+'" target="_blank" rel="noopener">–°–∫–∞—á–∞—Ç—å</a>' : '');
          meta.appendChild(audio);
          meta.appendChild(fallback);
        } else {
          const pNo = document.createElement('p');
          pNo.textContent = '–ê—É–¥–∏–æ—Ñ–∞–π–ª –Ω–µ —É–∫–∞–∑–∞–Ω';
          meta.appendChild(pNo);
        }
      } else if(drop.kind === 'art'){
        const p = document.createElement('p');
        p.textContent = drop.note || '–ê—Ä—Ç';
        meta.appendChild(p);
      }

      // Actions: download & remove
      const actions = document.createElement('p');
      actions.style.marginTop = '10px';
      if(drop.downloadUrl && drop.kind === 'track'){
        const a = document.createElement('a');
        a.href = drop.downloadUrl;
        a.target = '_blank';
        a.rel = 'noopener';
        a.textContent = '–°–∫–∞—á–∞—Ç—å —Ç—Ä–µ–∫';
        a.style.color = 'var(--accent)';
        a.style.marginRight = '12px';
        actions.appendChild(a);
      }
      const removeBtn = document.createElement('button');
      removeBtn.textContent = '–£–¥–∞–ª–∏—Ç—å';
      removeBtn.addEventListener('click', () => {
        if(confirm('–£–¥–∞–ª–∏—Ç—å –¥—Ä–æ–ø "' + drop.title + '"?')){
          removeDrop(drop.id);
        }
      });
      actions.appendChild(removeBtn);
      meta.appendChild(actions);

      header.appendChild(meta);
      container.appendChild(header);
      return container;
    }

    function renderAll(){
      const root = document.getElementById('drops-container');
      root.innerHTML = '';
      const drops = loadDrops();
      drops.forEach(d => {
        root.appendChild(createDropElement(d));
      });
    }

    function addDrop(drop){
      const drops = loadDrops();
      drops.unshift(drop);
      saveDrops(drops);
      renderAll();
    }

    function removeDrop(id){
      let drops = loadDrops();
      drops = drops.filter(d => d.id !== id);
      saveDrops(drops);
      renderAll();
    }

    // Helpers to prompt user for input
    function promptTrack(){
      const title = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞:', '–ù–æ–≤—ã–π —Ç—Ä–µ–∫');
      if(!title) return;
      const audioUrl = prompt('–°—Å—ã–ª–∫–∞ –Ω–∞ –∞—É–¥–∏–æ (–ø—Ä—è–º–∞—è MP3/OGG) –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (fallback):', '');
      const audioType = audioUrl && audioUrl.endsWith('.mp3') ? 'audio/mpeg' : (audioUrl && audioUrl.endsWith('.ogg') ? 'audio/ogg' : '');
      const cover = prompt('–°—Å—ã–ª–∫–∞ –Ω–∞ –æ–±–ª–æ–∂–∫—É (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ):', '');
      const bpm = prompt('BPM (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):', '');
      const duration = prompt('–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):', '');
      const downloadUrl = prompt('–°—Å—ã–ª–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):', '');

      const drop = {
        id: 'track-' + Date.now(),
        kind: 'track',
        title: title,
        audioUrl: audioUrl || '',
        audioType: audioType || '',
        cover: cover || '',
        bpm: bpm || '',
        duration: duration || '',
        downloadUrl: downloadUrl || ''
      };
      addDrop(drop);
    }

    function promptArt(){
      const title = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ –∞—Ä—Ç–∞:', '–ù–æ–≤—ã–π –∞—Ä—Ç');
      if(!title) return;
      const cover = prompt('–°—Å—ã–ª–∫–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:', '');
      const note = prompt('–ö–æ—Ä–æ—Ç–∫–∞—è –∑–∞–º–µ—Ç–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):', '');
      const drop = {
        id: 'art-' + Date.now(),
        kind: 'art',
        title: title,
        cover: cover || '',
        note: note || ''
      };
      addDrop(drop);
    }

    // Export current drops as JSON (opens in new tab)
    function exportJson(){
      const data = JSON.stringify(loadDrops(), null, 2);
      const blob = new Blob([data], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      window.open(url, '_blank');
      setTimeout(()=>URL.revokeObjectURL(url), 10000);
    }

    // Reset to defaults (clears storage)
    function resetDefaults(){
      if(confirm('–°–±—Ä–æ—Å–∏—Ç—å –¥—Ä–æ–ø—ã –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é? –í—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')){
        localStorage.removeItem(STORAGE_KEY);
        renderAll();
      }
    }

    // Attach UI handlers
    document.getElementById('add-track').addEventListener('click', promptTrack);
    document.getElementById('add-art').addEventListener('click', promptArt);
    document.getElementById('export').addEventListener('click', exportJson);
    document.getElementById('reset-sample').addEventListener('click', resetDefaults);

    // Initial render
    renderAll();

    // –ù–µ–±–æ–ª—å—à–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞: –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ, —è –º–æ–≥—É –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é —Å —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π –∏–ª–∏ —Ñ–æ—Ä–º–æ–π –≤–º–µ—Å—Ç–æ prompt
  </script>
</body>
</html>
